<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Shared folders 2018 - ozp-backend</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Shared folders 2018";
    var mkdocs_page_input_path = "features/shared_folders_2018.md";
    var mkdocs_page_url = "/features/shared_folders_2018/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> ozp-backend</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../ascii-entities/">Ascii entities</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../debugging/">Debugging</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../developer/">Developer</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../domain_knowledge/">Domain knowledge</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../jenkins/">Jenkins</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../requirements/">Requirements</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Features</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../notification/">Notification</a>
                </li>
                <li class="">
                    
    <a class="" href="../recommender_2017/">Recommender 2017</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Shared folders 2018</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#business-objective-bookmarks-hud">Business Objective - Bookmarks (hud)</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#terms-and-definitions">Terms and Definitions</a></li>
        
            <li><a class="toctree-l4" href="#implementation-of-legacy-bookmarks">Implementation of Legacy Bookmarks</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#business-objective-shared-bookmarks-aml30-draft-05032018">Business Objective - Shared Bookmarks (aml3.0 draft - 05/03/2018)</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#terms-and-definitions_1">Terms and Definitions</a></li>
        
            <li><a class="toctree-l4" href="#ui-interactions">UI Interactions</a></li>
        
            <li><a class="toctree-l4" href="#requirements">Requirements</a></li>
        
            <li><a class="toctree-l4" href="#api">API</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#database-structure">Database Structure</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#existing-tables">Existing Tables</a></li>
        
            <li><a class="toctree-l4" href="#methods-without-using-custom-order">Methods without using custom order</a></li>
        
            <li><a class="toctree-l4" href="#methods-with-custom-order-integer-position-field">Methods with custom order (integer position field)</a></li>
        
            <li><a class="toctree-l4" href="#methods-to-maintain-backward-compatability">Methods to maintain backward compatability</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#reference">Reference</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#links">Links</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../smart_search/">Smart search</a>
                </li>
                <li class="">
                    
    <a class="" href="../wiki/">Wiki</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">ozp-backend</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Features &raquo;</li>
        
      
    
    <li>Shared folders 2018</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="business-objective-bookmarks-hud">Business Objective - Bookmarks (hud)</h1>
<h2 id="terms-and-definitions">Terms and Definitions</h2>
<ul>
<li>bookmark - enabled quick access for listing</li>
</ul>
<p>concept of shared folder was to make a</p>
<h2 id="implementation-of-legacy-bookmarks">Implementation of Legacy Bookmarks</h2>
<ul>
<li>https://github.com/aml-development/ozp-backend/issues/7</li>
<li>https://github.com/aml-development/ozp-backend/pull/252</li>
</ul>
<h1 id="business-objective-shared-bookmarks-aml30-draft-05032018">Business Objective - Shared Bookmarks (aml3.0 draft - 05/03/2018)</h1>
<p>Add support for sharable folders</p>
<h2 id="terms-and-definitions_1">Terms and Definitions</h2>
<ul>
<li>bookmark - can represent a folder or listing</li>
<li>folder bookmark - group of listing bookmarks</li>
<li>shared folder owners - users who own shared folder</li>
<li>listing owners - users who own listing</li>
</ul>
<h2 id="ui-interactions">UI Interactions</h2>
<ul>
<li>Should show all bookmarks</li>
<li>User management component<ul>
<li>Get all users permission for a folder (username, role) ordered by role, username?</li>
<li>Change Role for a person for a folder</li>
</ul>
</li>
<li>Get share-able link</li>
</ul>
<h2 id="requirements">Requirements</h2>
<h3 id="general">General</h3>
<ul>
<li>When the folder is updated by any owner, the folder updates are visible to all users after calling api again (refresh)</li>
</ul>
<h3 id="permissions">Permissions</h3>
<ul>
<li>Should allow users to share a folder that is maintained by one or more users (owner).<ul>
<li>what type of users?</li>
</ul>
</li>
<li>Shared Folder Viewer Should be able to<ul>
<li>get a list of bookmarks</li>
</ul>
</li>
<li>Shared Folder Owner should be able to<ul>
<li>modify the folder</li>
<li>add other owners</li>
<li>delete delete owners</li>
<li>change permissions</li>
<li>Everything a Shared Folder Viewer can do</li>
</ul>
</li>
<li>Shared Folder Owner should be able to see user management component</li>
<li>Shared Folder Viewer should <strong>not</strong> be able to see user management component</li>
</ul>
<h3 id="notifications">Notifications</h3>
<ul>
<li>Send notification for updates to all owners/viewers of shared folder<ul>
<li>updates<ul>
<li>[ ] Adding user to shared folder</li>
<li>[ ] Removing user from shared folder</li>
<li>[x] Adding listing to shared folder</li>
<li>[x] Removing listing from shared folder</li>
<li>[ ] Changing permissions of a user for shared folder</li>
<li>[x] Removing shared folder</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="un-categorized">Un-categorized</h3>
<p>Owners and Viewers are two different user type</p>
<p>The folder should have 'viewers' that can only view, but not edit, the folder, should not see user management component</p>
<p>The UI component, when available, would let the folder creator select users to share to, and set their permissions (similar in the way google sheets/docs sharing works).</p>
<p>We will also maintain the concept of a copied folder, but will also add a true 'shared' folder.</p>
<p>Regular Folder, Duplicate Folder, Shared Folder  are the different types of folder</p>
<p>if user send a shareable link to someone without access to folder,
should we send a notification to the owners saying
"User requesting access to folder,  allow - denied access",
the user side it would be "Access Denied - request for access button"
or will it be public anyone can view folder?</p>
<h3 id="acceptance-criteria">Acceptance Criteria</h3>
<p>A new type of bookmark folder is available in the backend, that has permissions associated with it (view/edit)</p>
<h2 id="api">API</h2>
<p>http://www.django-rest-framework.org/api-guide/filtering/#filtering-and-object-lookups</p>
<h3 id="operations">operations</h3>
<ul>
<li>bookmark<ul>
<li>create - POST: /api/bookmark - create bookmark listing</li>
<li>list - GET: /api/bookmark/?type=LISTING - list all bookmarks (listing)</li>
<li>bulk update</li>
</ul>
</li>
<li>folder<ul>
<li>create - POST /api/bookmark/ - create bookmark folder</li>
<li>lists  - GET: /api/bookmark/?type=FOLDER - list all bookmarks (folders/shared folders)</li>
</ul>
</li>
<li>children<ul>
<li>add - PUT : /bookmark/{parentId}/children/{childId} -Adds child to a Folder</li>
<li>move - POST: /bookmark/{toparentId}/children  Move a child from one node to another</li>
<li>delete - DELETE : /bookmark/{parentId}/children/{childId} - Removes the child</li>
<li>list - GET : /bookmark/{id}/children - Lists all children</li>
</ul>
</li>
</ul>
<h1 id="database-structure">Database Structure</h1>
<h2 id="existing-tables">Existing Tables</h2>
<ul>
<li>Listing</li>
<li>Profile</li>
<li>User</li>
</ul>
<h2 id="methods-without-using-custom-order">Methods without using custom order</h2>
<h3 id="method-1-relational-self-reference-child-parent">Method 1 - Relational self-reference (child-parent)</h3>
<h4 id="models">Models</h4>
<ul>
<li>
<p>Bookmark</p>
<ul>
<li>id (integer)</li>
<li>name of folder (string)</li>
<li>listing id (foreign key)</li>
<li>root (boolean)</li>
<li>parent_id (foreign_key to bookmarks)</li>
<li>created_date (datetime)</li>
<li>type (choice - folder/listing)</li>
</ul>
</li>
<li>
<p>bookmarks_permission (m2m table - who can view bookmarks)</p>
<ul>
<li>id (integer)</li>
<li>profile (foreign_id)</li>
<li>permission (owner/viewer)</li>
<li>bookmark (foreign_key to bookmarks id)</li>
</ul>
</li>
</ul>
<p><strong>Optional Tables:</strong></p>
<ul>
<li>bookmark_parent_relationships (m2m table - storage of child-parent relationships)<ul>
<li>id (integer)</li>
<li>bookmark (foreign_key to bookmarks id)</li>
<li>parent_bookmark (foreign_key to bookmarks id, 1 bookmark can have many parents)</li>
</ul>
</li>
</ul>
<p>when would <code>bookmark_parent_relationships</code> table be good to use?</p>
<p>Rules
* Each user has only one bookmark root folder, the user is the owner of root folder
    * bookmarks.objects.filter(root=true, )</p>
<h4 id="methods-pseudocode">Methods (pseudocode)</h4>
<h5 id="getting-root-folder-for-user">Getting root folder for user</h5>
<pre><code>def get_create_root_folder(request_profile):
    &quot;&quot;&quot;
    returns one bookmark model object
    &quot;&quot;&quot;

</code></pre>

<h2 id="methods-with-custom-order-integer-position-field">Methods with custom order (integer position field)</h2>
<pre><code>[Listing,...] = List
(Type-Title[Listing,...]) = Folder

bigbrother
[
  (
    Shard-F1
      [1, 2]
  )
  (
      Folder-F2
      [1]
  )
  1
  2
]

jones
  [
    1
    (
      Shared-F1
        [1,2]
    )
    3
  ]

</code></pre>

<p>Table View for entries</p>
<pre><code>username   | folder_name | listing | position
---------------------------------------------
bigbrother (1) | s1          | 1       | 1 (nested order = 7)
bigbrother (1) | s1          | 2       | 1 (nested order = 8)

bigbrother (1) | f1          | 1       | 2 (nested order?)
bigbrother (1) | f1          | 4       | 2 (nested order?)

bigbrother (1) | null        | 1       | 3
bigbrother (1) | null        | 2       | 4

jones      (2) | null        | 1       | 1
jones      (2) | s1          | 1       | 1 (nested order = 7)
jones      (2) | s1          | 2       | 1 (nested order = 8)
jones      (2) | null        | 3       | 6

</code></pre>

<h3 id="method-2-relational-self-reference">Method 2 - Relational self-reference</h3>
<p>Table <code>entry_profile</code></p>
<p>Table <code>entry</code></p>
<h3 id="method-3-relational-fully-normalized">Method 3 - Relational fully normalized</h3>
<p>Tables</p>
<pre><code>Table `profile`                 |   Table `Listing`
                                |
id | username                   |   id | ...
1  | bigbrother                 |   1  |
2  | jones                      |   2  |
                                |   3  |
                                |
Table `folder_entry `           |  Table `entry_permission`
                                |
id | name | entry               |  id | entry | profile | permission
1  | S1   | 1                   |  1  | 1     | 1       | owner
2  | F1   | 2                   |  2  | 1     | 2       | viewer
                                |
                                |
Table `folder_listing_entry`    |    Table `listing_entry`
                                |    id  | listing | entry
id | listing | folder | entry   |    1   | 1       | 3
1  | 1       | 1      | 7       |    2   | 2       | 4
2  | 2       | 1      | 8       |    3   | 1       | 5
3  | 1       | 2      | 9       |    4   | 3       | 6


Table `entry`

id  | creator (profile)
1   |  1
2   |  1
3   |  1
4   |  1
5   |  2
6   |  2
7   |  1
8   |  1
9   |  2

Table `entry_position`

id | entry | profile | position
1  | 1     | 1       | 1
2  | 2     | 1       | 2
3  | 3     | 1       | 3
4  | 4     | 1       | 4
5  | 7     | 1       | 1
6  | 8     | 1       | 2
7  | 9     | 1       | 1
8  | 5     | 2       | 1
9  | 1     | 2       | 2
10 | 7     | 2       | 1
11 | 8     | 2       | 2
12 | 6     | 2       | 3
</code></pre>

<h2 id="methods-to-maintain-backward-compatability">Methods to maintain backward compatability</h2>
<h3 id="method-4-create-v2-api-for-30-use">Method 4 - Create V2 API for 3.0 use</h3>
<ul>
<li>look at method 1</li>
</ul>
<h3 id="method-5-create-a-secondary-api-for-shared-folders">Method 5 - Create a secondary API for shared folders</h3>
<ul>
<li>This will leave the current bookmark folder structure intact</li>
<li>Will require frontend to call 2 API methods to receive personal and shared folders</li>
<li>Will not require a full re-structure of bookmarks and folders from 2.0</li>
</ul>
<h1 id="reference">Reference</h1>
<h2 id="links">Links</h2>
<ul>
<li>https://stackoverflow.com/questions/9736548/database-schema-how-the-relationship-can-be-designed-between-user-file-and-fol</li>
<li>https://doc.owncloud.org/server/latest/developer_manual/core/ocs-share-api.html#ocs-share-api-create-share-response-attributes</li>
<li>https://docs.datastax.com/en/playlist/doc/java/playlistArchitecture.html</li>
<li>https://developers.google.com/drive/api/v3/about-files</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../smart_search/" class="btn btn-neutral float-right" title="Smart search">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../recommender_2017/" class="btn btn-neutral" title="Recommender 2017"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../recommender_2017/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../smart_search/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../../js/theme.js"></script>

</body>
</html>
